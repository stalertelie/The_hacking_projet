<!-- Copyright (C) 2017 Mozenda, Inc. All rights reserved. -->

<Agent>
  <Version>1.0k</Version>
  <IeVersion>11.674</IeVersion>
  <TemplateID>0</TemplateID>
  <AgentDefinition>

    <!--- - - - - - - - Browser Proxy Bypass Expressions - - - - - - - - -->

    <BrowserProxyBypassExpressionList>
      <BrowserProxyBypassExpression>regex:(?i)(mozenda\\.com|doubleclick\\.net|sitescout\\.com|moatads\\.com|mookie\\.com|adrta\\.com|adsafeprotected\\.com|mookie\\.com)</BrowserProxyBypassExpression>
      <BrowserProxyBypassExpression>regex:(?i)(\\.css|\\.js|\\.font)$</BrowserProxyBypassExpression>
      <BrowserProxyBypassExpression>regex:(?i)(\\.)(bitmap|bmp|gif|ico|icon|jpe|jpeg|jpg|mng|ora|pix|png|psd|svg|tga|tiff?)(\\?|$)</BrowserProxyBypassExpression>
      <BrowserProxyBypassExpression>regex:(?i)(\\.mpg|\\.mpeg|\\.swf|\\.flv|\\.ogg|\\.webm|\\.mp4|\\.mp3|\\.wav)$</BrowserProxyBypassExpression>
      <BrowserProxyBypassExpression>regex:(?i)(gstatic\\.com|googleapis\\.com|googlesyndication\\.com|google-analytics\\.com)</BrowserProxyBypassExpression>
    </BrowserProxyBypassExpressionList>
    <!--- - - - - - - - Actions - - - - - - - - -->

    <ActionList>

      <Action>
        <ActionID>Action-0</ActionID>
        <ActionType>LoadPage</ActionType>
        <Page>0</Page>
        <DestinationPage>1</DestinationPage>
        <TopLevelNav>True</TopLevelNav>
        <TopLevelNavCount>1</TopLevelNavCount>
        <PageUrl>http://annuaire-des-mairies.com/95/</PageUrl>
      </Action>

      <!-- Page 1 -->

      <Action>
        <ActionID>Action-1</ActionID>
        <ActionType>PagePlaceHolder</ActionType>
        <Page>1</Page>
        <LoadUrl>http://annuaire-des-mairies.com/95/</LoadUrl>
        <BaseUrl>http://annuaire-des-mairies.com/95/</BaseUrl>
        <CaptureScreenShot>False</CaptureScreenShot>
      </Action>

      <Action>
        <ActionID>Action-2</ActionID>
        <ActionType>BeginAnchorList</ActionType>
        <Page>1</Page>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>//pre[1]/a</ItemXPath>
        <ItemXPath>/html[1]/body[1]/pre[1]/a</ItemXPath>
        <ListName>CityList</ListName>
        <ListItemExcludeBegin>5</ListItemExcludeBegin>
        <PreloadActionNodes>True</PreloadActionNodes>
        <AutomaticallyAddCaptureActions>False</AutomaticallyAddCaptureActions>
      </Action>

      <Action>
        <ActionID>Action-4</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Description>Captures the text of the list item</Description>
        <Page>1</Page>
        <FieldExpression>href=&amp;quot;%URL%&amp;quot;&amp;gt;%ID%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>.</ItemXPath>
        <FieldValueType>Outer</FieldValueType>
      </Action>

      <Action>
        <ActionID>Action-5</ActionID>
        <ActionType>ClickElement</ActionType>
        <Page>1</Page>
        <DestinationPage>2</DestinationPage>
        <TopLevelNav>True</TopLevelNav>
        <TopLevelNavCount>1</TopLevelNavCount>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>.</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-3</ActionID>
        <ActionType>EndList</ActionType>
        <Page>1</Page>
        <ListName>CityList</ListName>
      </Action>

      <!-- Page 2 -->

      <Action>
        <ActionID>Action-6</ActionID>
        <ActionType>PagePlaceHolder</ActionType>
        <Page>2</Page>
        <WaitAjax>2</WaitAjax>
        <LoadUrl>http://annuaire-des-mairies.com/95/ableiges.html</LoadUrl>
        <BaseUrl>http://annuaire-des-mairies.com/95/ableiges.html</BaseUrl>
        <CaptureScreenShot>False</CaptureScreenShot>
      </Action>

      <Action>
        <ActionID>Action-7</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>Commune de %CITY% - %ZIP%</FieldExpression>
        <FieldExpression>Commune de %CITY%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>//div[1]/h1[1]</ItemXPath>
        <ItemXPath>/html[1]/body[1]/table[1]/tbody[1]/tr[3]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[2]/div[1]/h1[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-9</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>%ADR1% -</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>//td[1]/table[4]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[1]/td[2]/p[1]</ItemXPath>
        <ItemXPath>/html[1]/body[1]/table[1]/tbody[1]/tr[3]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[4]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[1]/td[2]/p[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-8</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>regex:(?&amp;lt;Email&amp;gt;[A-Za-z0-9!#$%&amp;amp;&amp;#39;*+/=?^_`{|}~-]+(?:\\.[A-Za-z0-9!#$%&amp;amp;&amp;#39;*+/=?^_`{|}~-]+)*@(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\\.)+[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?)</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <AssociatedTextXPath>//p[normalize-space(.)=&amp;#39;Adresse Email:&amp;#39;]</AssociatedTextXPath>
        <ItemXPath>../following-sibling::td[1]/p[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-10</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>%habitants%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <AssociatedTextXPath>//b[normalize-space(.)=&amp;quot;Nombre d&amp;#39;habitants &amp;#224; ABLEIGES:&amp;quot;]</AssociatedTextXPath>
        <ItemXPath>../../../following-sibling::td[1]/p[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-11</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>%site web%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <AssociatedTextXPath>//b[normalize-space(.)=&amp;#39;Site web de la Mairie:&amp;#39;]</AssociatedTextXPath>
        <ItemXPath>../../../following-sibling::td[1]/p[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-12</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>%CIVILITE% %MAIRE%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <ItemXPath>//td[1]/table[4]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[5]/td[2]/p[1]/font[1]</ItemXPath>
        <ItemXPath>/html[1]/body[1]/table[1]/tbody[1]/tr[3]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[4]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[5]/td[2]/p[1]/font[1]</ItemXPath>
      </Action>

      <Action>
        <ActionID>Action-13</ActionID>
        <ActionType>GetElementValue</ActionType>
        <Page>2</Page>
        <IsOptional>True</IsOptional>
        <FieldExpression>%DESCRIPTION%</FieldExpression>
        <ItemType>PlaceHolder</ItemType>
        <AssociatedTextXPath>//b[normalize-space(.)=&amp;#39;Pr&amp;#233;sentation de la commune de&amp;#39;]</AssociatedTextXPath>
        <ItemXPath>../../../../following-sibling::tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[2]/p[1]</ItemXPath>
      </Action>

    </ActionList>

  </AgentDefinition>
</Agent>